<!--
title: BX.util
description: 
published: true
date: 2021-12-20T16:17:44.876Z
tags: 
editor: ckeditor
dateCreated: 2021-12-18T20:21:48.502Z
-->

<p>Сборник функций-утилит.</p>
<h2>BX.util.array_values(object)</h2>
<p>Возвращает массив со всеми значениями переданного массива. Функция заново индексирует возвращаемый массив числовыми индексами.</p>
<pre><code class="language-javascript">const arr = BX.util.array_values(
  {
    'key1': 'value1',
    'key2': 'value2',
    'key3': 'value3',
  }
)
console.log(arr);   // ['value1', 'value2', 'value3']</code></pre>
<p>&nbsp;</p>
<h2>BX.util.array_keys(object)</h2>
<p>Возвращает числовые и строковые ключи, содержащиеся в переданном массиве.</p>
<pre><code class="language-javascript">const keys = BX.util.array_keys(
  {
    'key1': 'value1',
    'key2': 'value2',
    'key3': 'value3',
  }
)
console.log(keys);   // ['key1', 'key2', 'key3']</code></pre>
<p>&nbsp;</p>
<h2>BX.util.array_merge(first, second)</h2>
<p>Сливает два массива в один.</p>
<pre><code class="language-javascript">const arr = BX.util.array_merge(
  ['a', 'b', 'c'],
  ['d', 'e', 'f']
);

console.log(arr);   // ['a', 'b', 'c', 'd', 'e', 'f']</code></pre>
<p>&nbsp;</p>
<h2>BX.util.array_flip(object)</h2>
<p>Меняет местами ключи и значения у объекта</p>
<pre><code class="language-javascript">BX.util.array_flip({
    'key1': 'value1',
    'key2': 'value2',
    'key3': 'value3',
  }) // {value1: 'key1', value2: 'key2', value3: 'key3'}</code></pre>
<p>&nbsp;</p>
<h2>BX.util.array_diff(ar1, ar2, hash)</h2>
<p>Сравнивает два массива. Возвращает все значения из <code>ar1</code>, которых нет в <code>ar2</code>. Если передать третьим параметром <code>hash</code> имя функции, то сравниваются результаты выполнения этой функции с аргументом-значением.</p>
<pre><code class="language-javascript">BX.util.array_diff(
  ['key1', 'key2', 'KEY3'],
  ['key1', 'key2', 'key3']
)  // ['KEY3']

const lowerCase = function(str) { return str.toLowerCase() }
BX.util.array_diff(
  ['key1', 'key2', 'KEY3'],
  ['key1', 'key2', 'key3'],
  lowerCase
)  // []</code></pre>
<p>&nbsp;</p>
<h2>BX.util.array_unique()</h2>
<p>Убирает повторяющиеся значения из массива</p>
<pre><code class="language-javascript">const arr = BX.util.array_unique(
  ['a', 'b', 'c', 'd', 'e', 'f', 'a', 'c', 'g']
)

console.log(arr);   // ['a', 'b', 'c', 'd', 'e', 'f', 'g']</code></pre>
<p>&nbsp;</p>
<h2>BX.util.in_array(value, array)</h2>
<p>Проверяет, присутствует ли в массиве значение</p>
<pre><code class="language-javascript">console.log(BX.util.in_array('a', ['a', 'b', 'c'])) //true

console.log(BX.util.in_array('d', ['a', 'b', 'c'])) //false</code></pre>
<p>&nbsp;</p>
<h2>BX.util.array_search(str)</h2>
<p>Осуществляет поиск данного значения в массиве и возвращает ключ первого найденного элемента в случае успешного выполнения. В случае отсутствия значение в массиве возвращается -1</p>
<pre><code class="language-javascript">console.log(BX.util.array_search('a', ['a', 'b', 'c'])) // 0

console.log(BX.util.array_search('c', ['a', 'b', 'c'])) // 2

console.log(BX.util.array_search('d', ['a', 'b', 'c'])) // -1</code></pre>
<p>&nbsp;</p>
<h2>BX.util.trim(str)</h2>
<p>Удаляет пробелы (или другие символы) из начала и конца строки. Работает только со строками, применяется стандартная функция trim(). Если передавать другой тип данных, функция возвращает переданное.</p>
<pre><code class="language-javascript">BX.util.trim('   abcd   '); // 'abcd'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.htmlspecialchars(str)</h2>
<p>Преобразует специальные символы в HTML-сущности. В HTML некоторые символы имеют особый смысл и должны быть представлены в виде HTML-сущностей, чтобы сохранить их значение. Эта функция возвращает строку, над которой проведены эти преобразования.</p>
<p>Производятся следующие преобразования:</p>
<figure class="table">
  <table>
    <thead>
      <tr>
        <th>Символ</th>
        <th>Замена</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>&amp;</code> (амперсанд)</td>
        <td><code>&amp;amp;</code></td>
      </tr>
      <tr>
        <td><code>"</code> (двойные кавычки)</td>
        <td><code>&amp;quot;</code></td>
      </tr>
      <tr>
        <td><code>'</code> (одинарные кавычки)</td>
        <td><code>&amp;#039;</code></td>
      </tr>
      <tr>
        <td><code>&lt;</code> (меньше)</td>
        <td><code>&amp;lt;</code></td>
      </tr>
      <tr>
        <td><code>&gt;</code> (больше)</td>
        <td><code>&amp;gt;</code></td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<pre><code class="language-javascript">BX.util.htmlspecialchars('&amp;') // '&amp;amp;'
BX.util.htmlspecialchars('"') // '&amp;quot;'
BX.util.htmlspecialchars('\'') // '&amp;#39;'
BX.util.htmlspecialchars('&lt;') // '&amp;lt;'
BX.util.htmlspecialchars('&gt;') // '&amp;gt;'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.htmlspecialcharsback(str)</h2>
<p>Производит преобразование строки, обратное тому, что делает функция <code>BX.util.htmlspecialchars</code> .</p>
<pre><code class="language-javascript">BX.util.htmlspecialcharsback('&amp;amp;') // '&amp;'
BX.util.htmlspecialcharsback('&amp;quot;') // '"'
BX.util.htmlspecialcharsback('&amp;#39;') // "'"
BX.util.htmlspecialcharsback('&amp;lt;') // '&lt;'
BX.util.htmlspecialcharsback('&amp;gt;') // '&gt;'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.preg_quote(str, delimeter)</h2>
<p>Функция <code>BX.utill.preg_quote</code> принимает строку <code>str</code> и добавляет обратный слеш перед каждым служебным символом. Это бывает полезно, если в составлении шаблона участвуют строковые переменные, значение которых в процессе работы скрипта может меняться. В случае, если указан необязательный параметр <code>delimiter</code>, он будет также экранироваться.&nbsp;</p>
<p>В регулярных выражениях служебными считаются следующие символы: <code>. \ + * ? [ ^ ] $ ( ) { } = ! &lt; &gt; | : - #</code></p>
<pre><code class="language-javascript">BX.util.preg_quote('$40 за g3/400', '/') // '\\$40 за g3\\/400'
BX.util.preg_quote('*очень*') // '\\*очень\\*'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.str_pad(string, length, pad_string, pad_type)</h2>
<blockquote>
  <p>Функция устарела, используйте вместо нее <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/String/padStart"><i>.padStart()</i></a><i> и </i><a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/String/padEnd"><i>.padEnd()</i></a></p>
</blockquote>
<p>Эта функция возвращает строку <code>string</code>, дополненную слева, справа до заданной длины. Если необязательный аргумент <code>pad_string</code> не передан, то <code>string</code> будет дополнен пробелами, иначе он будет дополнен символами из <code>pad_string</code> до нужной длины. &nbsp;Необязательный аргумент <code>pad_type</code> указывает, с какой стороны дополнять строку и может иметь значение <code>'right’</code> &nbsp;или <code>'left’</code>. Если не указан, то по умолчанию используется <code>'right’</code>. &nbsp;</p>
<blockquote>
  <p><strong>Замечание</strong>:</p>
  <p><code>pad_string</code> может быть урезана, если необходимое количество дополняемых символов не делится нацело на длину строки <code>pad_string</code>.</p>
</blockquote>
<pre><code class="language-javascript">const input = 'Alien'
BX.util.str_pad(input, 10) // 'Alien     '
BX.util.str_pad(input, 10, "-=", 'right') // 'Alien-=-=-'
BX.util.str_pad(input, 10, "-=", 'left') // '-=-=-Alien'
BX.util.str_pad(input, 6, "___") // 'Alien_'
BX.util.str_pad(input, 3, "*") // 'Alien'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.strip_tags(<strong>string</strong>)</h2>
<p>Удаляет теги HTML из строки.</p>
<blockquote>
  <p><strong>Замечание</strong>: Комментарии HTML также будут удалены.&nbsp;</p>
</blockquote>
<pre><code class="language-javascript">BX.util.strip_tags('&lt;p&gt;Параграф.&lt;/p&gt;&lt;!-- Комментарий --&gt; &lt;a href="#fragment"&gt;Ещё текст&lt;/a&gt;') // 'Параграф. Ещё текст'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.urlencode()</h2>
<p>Кодирует строку посредством <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent">encodeURIComponent</a>, что приводит к некорректной декодировке на сайтах не в UTF. Для корректного приема закодированных таким образом данных на сервере можно выполнить функцию CUtil::JSPostUnescape, которая декодирует глобальные массивы $_GET, $_POST и $_REQUEST.</p>
<p>&nbsp;</p>
<h2><strong>BX.util.deleteFromArray</strong></h2>
<pre><code class="language-plaintext">Array
BX.util.deleteFromArray(
  array arr,
  int index
);</code></pre>
<p>Удаление элемента из массива с последующим сдвигом ключей.</p>
<pre><code class="language-javascript">BX.util.deleteFromArray(['a', 'b', 'c', 'd', 'e'], 3) // ['a', 'b', 'c', 'e']</code></pre>
<p>&nbsp;</p>
<h2><strong>BX.util.insertIntoArray</strong></h2>
<pre><code class="language-plaintext">Array
BX.util.insertIntoArray(
  array arr,
  int index, element
);&nbsp;</code></pre>
<p>Вставка элемента в массив с последующим сдвигом ключей.</p>
<pre><code class="language-javascript">BX.util.insertIntoArray(['a', 'b', 'c', 'd', 'e'], 3, 'x') // ['a', 'b', 'c', 'x', 'd', 'e']</code></pre>
<p>&nbsp;</p>
<h2><strong>BX.util.popup(</strong>string url, int width, int height )</h2>
<p>Показ попапа, спозиционированного по центру с контентом по адресу, указанным в параметре <code>url</code> .</p>
<pre><code class="language-javascript">BX.util.popup('https://ya.ru', 800, 600)  // показ страницы по адресу https://ya.ru
BX.util.popup('signin', 1200, 600) // можно указывать относительные url</code></pre>
<p>&nbsp;</p>
<h2>BX.util.getCssName(string)</h2>
<p>Преобразует стиль написания строки из camel case в kebab case</p>
<pre><code class="language-javascript">BX.util.getCssName('isEqual') // 'is-equal'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.getJsName(string)</h2>
<p>Преобразует стиль написания строки из kebab case в &nbsp;camel case</p>
<pre><code class="language-javascript">BX.util.getJsName('user-login-count') // 'userLoginCount'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.nl2br(string)</h2>
<p>Преобразует символ перевода строки \n в тег &lt;br&gt;</p>
<pre><code class="language-javascript">BX.util.nl2br('user\nlogin\ncount') // 'user&lt;br/&gt;login&lt;br/&gt;count'</code></pre>
<p>&nbsp;</p>
<h2>BX.util.shuffle(array)</h2>
<p>Перемешивает элементы массива в случайном порядке</p>
<pre><code class="language-javascript">BX.util.shuffle(['a', 'b', 'c', 'd', 'e']) // ['d', 'a', 'c', 'b', 'e']
BX.util.shuffle(['a', 'b', 'c', 'd', 'e']) // ['e', 'a', 'd', 'c', 'b']</code></pre>
<p>&nbsp;</p>
<h2>BX.util.objectSort(object, sortBy, sortDir)</h2>
<p>Преобразование значений объекта в виде объектов в массив объектов с сортировкой по указанному ключу. Параметр <code>sortDir</code> необязательный и может принимать значения <code>'asc'</code> или <code>'desc'</code>, по умолчанию устанавливается в <code>'desc'</code>.&nbsp;</p>
<pre><code class="language-javascript">BX.util.objectSort(
  {
    'L1': {'name': 'Last'},
    'F1': {'name': 'First'}
  },
  'name',
  'asc'
); // return: [{'name' : 'First'}, {'name' : 'Last'}]</code></pre>
<p>&nbsp;</p>
<p><a href="https://dev.1c-bitrix.ru/api_help/js_lib/kernel/utilits/bx_util.php">Документация Битрикс</a></p>
